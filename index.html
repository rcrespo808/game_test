<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grid Runner</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
        }

        canvas {
            display: block;
        }
    </style>
</head>

<body>
    <!-- Phaser 3 via CDN -->
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.min.js"></script>
    <!-- MIDI Parser and Tone.js via CDN (ESM) -->
    <script type="module">
        // Import MIDI parser and Tone.js dynamically, exposing globals for the modular code
        const midiPromise = import('https://cdn.jsdelivr.net/npm/@tonejs/midi@2.0.28/+esm')
            .then(midiModule => {
                const MidiParser = midiModule.Midi || midiModule.default?.Midi || midiModule.default || midiModule;
                window.MidiParser = MidiParser;
                return MidiParser;
            });

        const tonePromise = import('https://cdn.jsdelivr.net/npm/tone@14.7.77/+esm')
            .then(toneModule => {
                const Tone = toneModule.Tone || toneModule.default?.Tone || toneModule.default || toneModule;
                window.Tone = Tone;
                return Tone;
            });

        Promise.all([midiPromise, tonePromise])
            .then(([MidiParser, Tone]) => {
                console.log('>> MIDI parser and Tone.js loaded', { Tone: !!Tone, MidiParser: !!MidiParser });
            })
            .catch(err => {
                console.error('Failed to load MIDI/Tone libraries:', err);
                window.MidiParser = null;
                window.Tone = null;
            });
    </script>
    <!-- Game Logic -->
    <script type="module" src="./main.js"></script>
</body>

</html>
